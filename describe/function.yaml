kind: job
metadata:
  name: describe
  tag: ''
  hash: bdbc67980d86962fb0b816c9e25e2e0a6ee0b3f2
  project: ''
  labels:
    author: yjb
  categories:
  - analysis
spec:
  command: ''
  args: []
  image: mlrun/ml-models
  env: []
  default_handler: summarize
  entry_points:
    summarize:
      name: summarize
      doc: Summarize a table
      parameters:
      - name: context
        type: MLClientCtx
        doc: the function context
      - name: table
        type: DataItem
        doc: MLRun input pointing to pandas dataframe (csv/parquet file path)
      - name: label_column
        type: str
        doc: ground truth column label
        default: labels
      - name: class_labels
        type: List[str]
        doc: label for each class in tables and plots
      - name: plot_hist
        type: bool
        doc: (True) set this to False for large tables
        default: true
      - name: plots_dest
        type: str
        doc: destination folder of summary plots (relative to artifact_path)
        default: plots
      - name: sample
        type: float
        doc: '% or absolute number of samples to use'
        default: 1
      outputs: []
      lineno: 23
  description: describe and visualizes dataset stats
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IHdhcm5pbmdzCndhcm5pbmdzLnNpbXBsZWZpbHRlcihhY3Rpb249J2lnbm9yZScsIGNhdGVnb3J5PUZ1dHVyZVdhcm5pbmcpCgppbXBvcnQgb3MKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAppbXBvcnQgc2VhYm9ybiBhcyBzbnMKCmZyb20gbWxydW4uZXhlY3V0aW9uIGltcG9ydCBNTENsaWVudEN0eApmcm9tIG1scnVuLmRhdGFzdG9yZSBpbXBvcnQgRGF0YUl0ZW0KZnJvbSBtbHJ1bi5hcnRpZmFjdHMgaW1wb3J0IFBsb3RBcnRpZmFjdCwgVGFibGVBcnRpZmFjdApmcm9tIG1scnVuLm1sdXRpbHMgaW1wb3J0IGdjZl9jbGVhcgoKZnJvbSB5ZWxsb3dicmljayBpbXBvcnQgQ2xhc3NCYWxhbmNlCgpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdAoKcGQuc2V0X29wdGlvbigiZGlzcGxheS5mbG9hdF9mb3JtYXQiLCBsYW1iZGEgeDogIiUuMmYiICUgeCkKCmRlZiBzdW1tYXJpemUoCiAgICBjb250ZXh0OiBNTENsaWVudEN0eCwKICAgIHRhYmxlOiBEYXRhSXRlbSwKICAgIGxhYmVsX2NvbHVtbjogc3RyID0gImxhYmVscyIsCiAgICBjbGFzc19sYWJlbHM6IExpc3Rbc3RyXSA9IFtdLAogICAgcGxvdF9oaXN0OiBib29sID0gVHJ1ZSwKICAgIHBsb3RzX2Rlc3Q6IHN0ciA9ICJwbG90cyIsCiAgICBzYW1wbGU6IGZsb2F0ID0gMQopIC0+IE5vbmU6CiAgICAiIiJTdW1tYXJpemUgYSB0YWJsZQoKICAgIDpwYXJhbSBjb250ZXh0OiAgICAgICAgIHRoZSBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0gdGFibGU6ICAgICAgICAgICBNTFJ1biBpbnB1dCBwb2ludGluZyB0byBwYW5kYXMgZGF0YWZyYW1lIChjc3YvcGFycXVldCBmaWxlIHBhdGgpCiAgICA6cGFyYW0gbGFiZWxfY29sdW1uOiAgICBncm91bmQgdHJ1dGggY29sdW1uIGxhYmVsCiAgICA6cGFyYW0gY2xhc3NfbGFiZWxzOiAgICBsYWJlbCBmb3IgZWFjaCBjbGFzcyBpbiB0YWJsZXMgYW5kIHBsb3RzCiAgICA6cGFyYW0gcGxvdF9oaXN0OiAgICAgICAoVHJ1ZSkgc2V0IHRoaXMgdG8gRmFsc2UgZm9yIGxhcmdlIHRhYmxlcwogICAgOnBhcmFtIHBsb3RzX2Rlc3Q6ICAgICAgZGVzdGluYXRpb24gZm9sZGVyIG9mIHN1bW1hcnkgcGxvdHMgKHJlbGF0aXZlIHRvIGFydGlmYWN0X3BhdGgpCiAgICA6cGFyYW0gc2FtcGxlOiAgICAgICAgICAlIG9yIGFic29sdXRlIG51bWJlciBvZiBzYW1wbGVzIHRvIHVzZQogICAgIiIiCiAgICB0YWJsZSA9IHRhYmxlLmFzX2RmKCkKICAgIGhlYWRlciA9IHRhYmxlLmNvbHVtbnMudmFsdWVzCiAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCdMb2FkZWQgZGF0YXNldCcpCiAgICBpZiBzYW1wbGUgPiAxOgogICAgICAgIHRhYmxlID0gdGFibGUuc2FtcGxlKG49c2FtcGxlKQogICAgZWxpZiBzYW1wbGUgPCAxOgogICAgICAgIHRhYmxlID0gdGFibGUuc2FtcGxlKGZyYWM9c2FtcGxlKQogICAgY29udGV4dC5sb2dnZXIuaW5mbyhmJ1VzaW5nIHt0YWJsZS5zaGFwZVswXX0gc2FtcGxlcycpCiAgICAKICAgIGdjZl9jbGVhcihwbHQpCiAgICBzbnNwbHQgPSBzbnMucGFpcnBsb3QodGFibGUsIGh1ZT1sYWJlbF9jb2x1bW4sIGRpYWdfa3dzPXsiYnciOiAxLjV9KQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoUGxvdEFydGlmYWN0KCJoaXN0b2dyYW1zIiwgIGJvZHk9cGx0LmdjZigpKSwgbG9jYWxfcGF0aD1mIntwbG90c19kZXN0fS9oaXN0Lmh0bWwiKQoKICAgIGdjZl9jbGVhcihwbHQpICAgCiAgICBsYWJlbHMgPSB0YWJsZS5wb3AobGFiZWxfY29sdW1uKQogICAgaWYgbm90IGNsYXNzX2xhYmVsczoKICAgICAgICBjbGFzc19sYWJlbHMgPSBsYWJlbHMudW5pcXVlKCkKICAgIGNsYXNzX2JhbGFuY2VfbW9kZWwgPSBDbGFzc0JhbGFuY2UobGFiZWxzPWNsYXNzX2xhYmVscykKICAgIGNsYXNzX2JhbGFuY2VfbW9kZWwuZml0KGxhYmVscykgICAKICAgIHNjYWxlX3Bvc193ZWlnaHQgPSBjbGFzc19iYWxhbmNlX21vZGVsLnN1cHBvcnRfWzBdL2NsYXNzX2JhbGFuY2VfbW9kZWwuc3VwcG9ydF9bMV0KICAgIGNvbnRleHQubG9nX3Jlc3VsdCgic2NhbGVfcG9zX3dlaWdodCIsIGYie3NjYWxlX3Bvc193ZWlnaHQ6MC4yZn0iKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoUGxvdEFydGlmYWN0KCJpbWJhbGFuY2UiLCBib2R5PXBsdC5nY2YoKSksIGxvY2FsX3BhdGg9ZiJ7cGxvdHNfZGVzdH0vaW1iYWxhbmNlLmh0bWwiKQogICAgCiAgICBnY2ZfY2xlYXIocGx0KQogICAgdGJsY29yciA9IHRhYmxlLmNvcnIoKQogICAgYXggPSBwbHQuYXhlcygpCiAgICBzbnMuaGVhdG1hcCh0Ymxjb3JyLCBheD1heCwgYW5ub3Q9RmFsc2UsIGNtYXA9cGx0LmNtLlJlZHMpCiAgICBheC5zZXRfdGl0bGUoImZlYXR1cmVzIGNvcnJlbGF0aW9uIikKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KFBsb3RBcnRpZmFjdCgiY29ycmVsYXRpb24iLCAgYm9keT1wbHQuZ2NmKCkpLCBsb2NhbF9wYXRoPWYie3Bsb3RzX2Rlc3R9L2NvcnIuaHRtbCIpCgogICAgZ2NmX2NsZWFyKHBsdCkKCg==
    commands: []
    code_origin: https://github.com/mlrun/functions#1d1e4a97478e1194b73c78c4d9b0b6fe5d1dc162:describe.ipynb
