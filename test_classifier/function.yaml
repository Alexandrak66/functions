kind: job
metadata:
  name: test-classifier
  tag: ''
  hash: 638511370f81a098574038e07810a0b433104775
  project: ''
  labels:
    author: yjb
    stage: development
  categories:
  - models
  - test
spec:
  command: ''
  args: []
  image: mlrun/ml-models:latest
  env: []
  default_handler: test_classifier
  description: ''
  image_pull_policy: Always
  build:
    functionSourceCode: aW1wb3J0IG9zCmltcG9ydCBqc29uCmltcG9ydCBpbXBvcnRsaWIKZnJvbSBjbG91ZHBpY2tsZSBpbXBvcnQgbG9hZAoKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBwYW5kYXMgYXMgcGQKCmltcG9ydCBza2xlYXJuCmZyb20gc2tsZWFybiBpbXBvcnQgbWV0cmljcwpmcm9tIHNrbGVhcm4ucHJlcHJvY2Vzc2luZyBpbXBvcnQgbGFiZWxfYmluYXJpemUKZnJvbSBza2xlYXJuLnV0aWxzLm11bHRpY2xhc3MgaW1wb3J0IHVuaXF1ZV9sYWJlbHMKCmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHQKZnJvbSBtYXRwbG90bGliLmZpZ3VyZSBpbXBvcnQgRmlndXJlCmltcG9ydCBzZWFib3JuIGFzIHNucwoKZnJvbSB0eXBpbmcgaW1wb3J0IE9wdGlvbmFsLCBVbmlvbiwgTGlzdCwgVHVwbGUKCmZyb20gbWxydW4uZXhlY3V0aW9uIGltcG9ydCBNTENsaWVudEN0eApmcm9tIG1scnVuLmRhdGFzdG9yZSBpbXBvcnQgRGF0YUl0ZW0KZnJvbSBtbHJ1bi5hcnRpZmFjdHMgaW1wb3J0IFRhYmxlQXJ0aWZhY3QsIFBsb3RBcnRpZmFjdAoKaW1wb3J0IHdhcm5pbmdzCndhcm5pbmdzLnNpbXBsZWZpbHRlcihhY3Rpb249Imlnbm9yZSIsIGNhdGVnb3J5PUZ1dHVyZVdhcm5pbmcpCgpkZWYgX2djZl9jbGVhcihwbHQpOgogICAgcGx0LmNsYSgpCiAgICBwbHQuY2xmKCkKICAgIHBsdC5jbG9zZSgpICAgICAgICAKCmRlZiB0ZXN0X2NsYXNzaWZpZXIoCiAgICBjb250ZXh0OiBNTENsaWVudEN0eCwKICAgIG1vZGVsc19kaXI6IFVuaW9uW0RhdGFJdGVtLCBzdHJdLCAKICAgIHRlc3Rfc2V0OiBEYXRhSXRlbSwKICAgIGxhYmVsX2NvbHVtbjogc3RyLAogICAgc2NvcmVfbWV0aG9kOiBzdHIgPSAnbWljcm8nLAogICAga2V5OiBzdHIgPSAiIiwKICAgIHBsb3RzX2Rpcjogc3RyID0gInBsb3RzIgopIC0+IE5vbmU6CiAgICAiIiJUZXN0IG9uZSBvciBtb3JlIGNsYXNzaWZpZXIgbW9kZWxzIGFnYWluc3QgaGVsZC1vdXQgZGF0YXNldAogICAgCiAgICBVc2luZyBoZWxkLW91dCB0ZXN0IGZlYXR1cmVzLCBldmFsdWF0ZXMgdGhlIHBlZm9ybWFuY2Ugb2YgdGhlIGVzdGltYXRlZCBtb2RlbAogICAgCiAgICBDYW4gYmUgcGFydCBvZiBhIGt1YmVmbG93IHBpcGVsaW5lIGFzIGEgdGVzdCBzdGVwIHRoYXQgaXMgcnVuIHBvc3QgRURBIGFuZCAKICAgIHRyYWluaW5nL3ZhbGlkYXRpb24gY3ljbGVzCiAgICAKICAgIDpwYXJhbSBjb250ZXh0OiAgICAgICAgIHRoZSBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0gbW9kZWxzX2RpcjogICAgICBhcnRpZmFjdCBtb2RlbHMgcmVwcmVzZW50aW5nIGEgZm9sZGVyIG9yIGEgZm9sZGVyCiAgICA6cGFyYW0gdGVzdF9zZXQ6ICAgICAgICB0ZXN0IGZlYXR1cmVzIGFuZCBsYWJlbHMKICAgIDpwYXJhbSBsYWJlbF9jb2x1bW46ICAgIGNvbHVtbiBuYW1lIGZvciBncm91bmQgdHJ1dGggbGFiZWxzCiAgICA6cGFyYW0gc2NvcmVfbWV0aG9kOiAgICBmb3IgbXVsdGljbGFzcyBjbGFzc2lmaWNhdGlvbgogICAgOnBhcmFtIGtleTogICAgICAgICAgICAga2V5IGZvciByZXN1bHRzIGFydGlmYWN0IChtYXliZSBqdXN0IGEgZGlyIG9mIGFydGlmYWN0cyBmb3IgdGVzdCBsaWtlIHBsb3RzX2RpcikKICAgIDpwYXJhbSBwbG90c19kaXI6ICAgICAgIGRpciBmb3IgdGVzdCBwbG90cwogICAgIiIiCiAgICBvcy5tYWtlZGlycyhvcy5wYXRoLmpvaW4oY29udGV4dC5hcnRpZmFjdF9wYXRoLCBwbG90c19kaXIpLCBleGlzdF9vaz1UcnVlKQogICAgCiAgICB4dGVzdCA9IHBkLnJlYWRfcGFycXVldChzdHIodGVzdF9zZXQpKQogICAgeXRlc3QgPSB4dGVzdC5wb3AobGFiZWxfY29sdW1uKQogICAgCiAgICBjb250ZXh0LmhlYWRlciA9IGxpc3QoeHRlc3QuY29sdW1ucy52YWx1ZXMpCiAgICAKICAgIGRlZiBfZXZhbF9tb2RlbChtb2RlbCk6CiAgICAgICAgIyBlbmNsb3NlIGFsbCBleGNlcHQgbW9kZWwKICAgICAgICB5dGVzdGIgPSBsYWJlbF9iaW5hcml6ZSh5dGVzdCwgY2xhc3Nlcz1saXN0KHJhbmdlKHh0ZXN0LnNoYXBlWzFdKSkpCiAgICAgICAgY2xmID0gbG9hZChvcGVuKG9zLnBhdGguam9pbihzdHIobW9kZWxzX2RpciksIG1vZGVsKSwgInJiIikpCiAgICAgICAgaWYgY2FsbGFibGUoZ2V0YXR0cihjbGYsICJwcmVkaWN0X3Byb2JhIikpOgogICAgICAgICAgICB5X3Njb3JlID0gY2xmLnByZWRpY3RfcHJvYmEoeHRlc3QudmFsdWVzKQogICAgICAgICAgICB5cHJlZCA9IGNsZi5wcmVkaWN0KHh0ZXN0LnZhbHVlcykKICAgICAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbyhmInlfc2NvcmUuc2hhcGUge3lfc2NvcmUuc2hhcGV9IikKICAgICAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbyhmInl0ZXN0Yi5zaGFwZSB7eXRlc3RiLnNoYXBlfSIpCiAgICAgICAgICAgIHBsb3Rfcm9jKGNvbnRleHQsIHl0ZXN0YiwgeV9zY29yZSwga2V5PWYicm9jIiwgcGxvdHNfZGlyPXBsb3RzX2RpcikKICAgICAgICBlbHNlOgogICAgICAgICAgICB5cHJlZCA9IGNsZi5wcmVkaWN0KHh0ZXN0LnZhbHVlcykgIyByZWZhY3RvcgogICAgICAgICAgICB5X3Njb3JlID0gTm9uZQogICAgICAgIHBsb3RfY29uZnVzaW9uX21hdHJpeChjb250ZXh0LCB5dGVzdCwgeXByZWQsIGtleT0iY29uZnVzaW9uIiwgZm10PSJwbmciKQogICAgICAgIGlmIGhhc2F0dHIoY2xmLCAiZmVhdHVyZV9pbXBvcnRhbmNlc18iKToKICAgICAgICAgICAgcGxvdF9pbXBvcnRhbmNlKGNvbnRleHQsIGNsZiwga2V5PWYiZmVhdGltcCIpCiAgICAgICAgYXZlcmFnZV9wcmVjaXNpb24gPSBtZXRyaWNzLmF2ZXJhZ2VfcHJlY2lzaW9uX3Njb3JlKHl0ZXN0Yls6LDotMV0sIHlfc2NvcmUsIGF2ZXJhZ2U9c2NvcmVfbWV0aG9kKQogICAgICAgIGNvbnRleHQubG9nX3Jlc3VsdChmImFjY3VyYWN5IiwgZmxvYXQoY2xmLnNjb3JlKHh0ZXN0LnZhbHVlcywgeXRlc3QudmFsdWVzKSkpCiAgICAgICAgY29udGV4dC5sb2dfcmVzdWx0KGYicm9jYXVjIiwgbWV0cmljcy5yb2NfYXVjX3Njb3JlKHl0ZXN0YiwgeV9zY29yZSkpCiAgICAgICAgY29udGV4dC5sb2dfcmVzdWx0KGYiZjFfc2NvcmUiLCBtZXRyaWNzLmYxX3Njb3JlKHl0ZXN0LnZhbHVlcywgeXByZWQsIGF2ZXJhZ2U9c2NvcmVfbWV0aG9kKSkKICAgICAgICBjb250ZXh0LmxvZ19yZXN1bHQoZiJhdmdfcHJlY3Njb3JlIiwgYXZlcmFnZV9wcmVjaXNpb24pCgogICAgCiAgICBiZXN0X21vZGVsID0gTm9uZQogICAgZm9yIG1vZGVsIGluIG9zLmxpc3RkaXIoc3RyKG1vZGVsc19kaXIpKToKICAgICAgICBpZiBtb2RlbC5lbmRzd2l0aCgnLnBrbCcpOgogICAgICAgICAgICBfZXZhbF9tb2RlbChtb2RlbCkKICAgICAgICAgICAgIyBIQUNLOiB0aGVyZSBpcyBvbmx5IG9uZSBtb2RlbCBoZXJlCiAgICAgICAgICAgIGJlc3RfbW9kZWwgPSBtb2RlbAoKICAgICMgbG9nICdiZXN0IG1vZGVsJyBhcyBhcnRpZmFjdAogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoJ1RPREFZUy1NT0RFTFMtVEVTVC1SRVBPUlQnLCBsb2NhbF9wYXRoPWJlc3RfbW9kZWwpCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdCgnREVQTE9ZJywgYm9keT1iJ3RydWUnLCBsb2NhbF9wYXRoPSdERVBMT1knKQogICAgCmRlZiBwbG90X3JvYygKICAgIGNvbnRleHQsCiAgICB5X2xhYmVscywKICAgIHlfcHJvYnMsCiAgICBrZXk9InJvYyIsCiAgICBwbG90c19kaXI6IHN0ciA9ICJwbG90cyIsCiAgICBmbXQ9InBuZyIsCiAgICBmcHJfbGFiZWw6IHN0ciA9ICJmYWxzZSBwb3NpdGl2ZSByYXRlIiwKICAgIHRwcl9sYWJlbDogc3RyID0gICJ0cnVlIHBvc2l0aXZlIHJhdGUiLAogICAgdGl0bGU6IHN0ciA9ICJyb2MgY3VydmUiLAogICAgbGVnZW5kX2xvYzogc3RyID0gImJlc3QiCik6CiAgICAiIiJwbG90IHJvYyBjdXJ2ZXMKICAgIAogICAgVE9ETzogIGFkZCBhdmVyYWdpbmcgbWV0aG9kIChhcyBzdHJpbmcpIHRoYXQgd2FzIHVzZWQgdG8gY3JlYXRlIHByb2JzLCAKICAgIGRpc3BsYXkgaW4gbGVnZW5kCiAgICAKICAgIDpwYXJhbSBjb250ZXh0OiAgICAgIHRoZSBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0geV9sYWJlbHM6ICAgICBncm91bmQgdHJ1dGggbGFiZWxzLCBob3QgZW5jb2RlZCBmb3IgbXVsdGljbGFzcyAgCiAgICA6cGFyYW0geV9wcm9iczogICAgICBtb2RlbCBwcmVkaWN0aW9uIHByb2JhYmlsaXRpZXMKICAgIDpwYXJhbSBrZXk6ICAgICAgICAgICgicm9jIikga2V5IG9mIHBsb3QgaW4gYXJ0aWZhY3Qgc3RvcmUKICAgIDpwYXJhbSBwbG90c19kaXI6ICAgICgicGxvdHMiKSBkZXN0aW5hdGlvbiBmb2xkZXIgcmVsYXRpdmUgcGF0aCB0byBhcnRpZmFjdCBwYXRoCiAgICA6cGFyYW0gZm10OiAgICAgICAgICAoInBuZyIpIHBsb3QgZm9ybWF0CiAgICA6cGFyYW0gZnByX2xhYmVsOiAgICAoImZhbHNlIHBvc2l0aXZlIHJhdGUiKSB4LWF4aXMgbGFiZWxzCiAgICA6cGFyYW0gdHByX2xhYmVsOiAgICAoInRydWUgcG9zaXRpdmUgcmF0ZSIpIHktYXhpcyBsYWJlbHMKICAgIDpwYXJhbSB0aXRsZTogICAgICAgICgicm9jIGN1cnZlIikgdGl0bGUgb2YgcGxvdAogICAgOnBhcmFtIGxlZ2VuZF9sb2M6ICAgKCJiZXN0IikgbG9jYXRpb24gb2YgcGxvdCBsZWdlbmQKICAgICIiIgogICAgeV9sYWJlbHMgPSB5X2xhYmVsc1s6LCA6LTFdICMgbGFzdCBjb2x1bW4gcmVkdW5kYW50IChsYWJlbGJpbmFyaXplciBpc3N1ZT8pCiAgICBhc3NlcnQgeV9wcm9icy5zaGFwZSA9PSB5X2xhYmVscy5zaGFwZQogICAgCiAgICAjIGNsZWFyIG1hdHBsb3RsaWIgY3VycmVudCBmaWd1cmUKICAgIF9nY2ZfY2xlYXIocGx0KQogICAgCiAgICAjIGRhdGEgYWNjdW1tdWxhdG9ycyBieSBjbGFzcwogICAgZnByID0gZGljdCgpCiAgICB0cHIgPSBkaWN0KCkKICAgIHJvY19hdWMgPSBkaWN0KCkKICAgIAogICAgIyBkcmF3IDQ1IGRlZ3JlZSBsaW5lCiAgICBwbHQucGxvdChbMCwgMV0sIFswLCAxXSwgImstLSIpCiAgICAKICAgICMgbGFiZWxsaW5nCiAgICBwbHQueGxhYmVsKGZwcl9sYWJlbCkKICAgIHBsdC55bGFiZWwodHByX2xhYmVsKQogICAgcGx0LnRpdGxlKHRpdGxlKQogICAgcGx0LmxlZ2VuZChsb2M9bGVnZW5kX2xvYykKICAgIAogICAgIyBzaW5nbGUgUk9DIG9yIG11dGxpcGxlCiAgICBmb3IgaSBpbiByYW5nZSh5X2xhYmVsc1s6LDotMV0uc2hhcGVbMV0pOgogICAgICAgIGZwcltpXSwgdHByW2ldLCBfID0gbWV0cmljcy5yb2NfY3VydmUoeV9sYWJlbHNbOiwgaV0sIHlfcHJvYnNbOiwgaV0sIHBvc19sYWJlbD0xKQogICAgICAgIHJvY19hdWNbaV0gPSBtZXRyaWNzLmF1YyhmcHJbaV0sIHRwcltpXSkKICAgICAgICBwbHQucGxvdChmcHJbaV0sIHRwcltpXSwgbGFiZWw9ZiJjbGFzcyB7aX0iKQoKICAgIGZuYW1lID0gZiJ7cGxvdHNfZGlyfS97a2V5fS57Zm10fSIKICAgIHBsdC5zYXZlZmlnKG9zLnBhdGguam9pbihjb250ZXh0LmFydGlmYWN0X3BhdGgsIGZuYW1lKSkKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KFBsb3RBcnRpZmFjdChrZXksIGJvZHk9cGx0LmdjZigpKSwgbG9jYWxfcGF0aD1mbmFtZSkKICAgIAoKZGVmIHBsb3RfY29uZnVzaW9uX21hdHJpeCgKICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LAogICAgbGFiZWxzLAogICAgcHJlZGljdGlvbnMsCiAgICBrZXk6IHN0ciA9ICJjb25mdXNpb25fbWF0cml4IiwKICAgIHBsb3RzX2Rpcjogc3RyID0gInBsb3RzIiwKICAgIGNvbG9ybWFwOiBzdHIgPSAiQmx1ZXMiLAogICAgZm10OiBzdHIgPSAicG5nIiwKICAgIHNhbXBsZV93ZWlnaHQ9Tm9uZQopOgogICAgIiIiQ3JlYXRlIGEgY29uZnVzaW9uIG1hdHJpeC4KICAgIFBsb3QgYW5kIHNhdmUgYSBjb25mdXNpb24gbWF0cml4IHVzaW5nIHRlc3QgZGF0YSBmcm9tIGEKICAgIG1vZGVsbGluZSBzdGVwLgogICAgCiAgICBTZWUgaHR0cHM6Ly9zY2lraXQtbGVhcm4ub3JnL3N0YWJsZS9tb2R1bGVzL2dlbmVyYXRlZC9za2xlYXJuLm1ldHJpY3MuY29uZnVzaW9uX21hdHJpeC5odG1sCiAgICAKICAgIFRPRE86IGZpeCBsYWJlbCBhbGlnbm1lbnQKICAgIFRPRE86IGNvbnNpZGVyIHVzaW5nIGFub3RoZXIgcGFja2FnZWQgdmVyc2lvbgogICAgVE9ETzogcmVmYWN0b3IgdG8gdGFrZSBwYXJhbXMgZGljdCBmb3IgcGxvdCBvcHRpb25zCgogICAgOnBhcmFtIGNvbnRleHQ6ICAgICAgICAgZnVuY3Rpb24gY29udGV4dAogICAgOnBhcmFtIGxhYmVsczogICAgICAgICAgdmFsaWRhdGlvbiBkYXRhIGdyb3VuZC10cnV0aCBsYWJlbHMKICAgIDpwYXJhbSBwcmVkaWN0aW9uczogICAgIHZhbGlkYXRpb24gZGF0YSBwcmVkaWN0aW9ucwogICAgOnBhcmFtIGtleTogICAgICAgICAgICAgc3RyCiAgICA6cGFyYW0gcGxvdHNfZGlyOiAgICAgICByZWxhdGl2ZSBwYXRoIG9mIHBsb3RzIGluIGFydGlmYWN0IHN0b3JlCiAgICA6cGFyYW0gY29sb3JtYXA6ICAgICAgICBjb2xvdXJtYXAgZm9yIGNvbmZ1c2lvbiBtYXRyaXgKICAgIDpwYXJhbSBmbXQ6ICAgICAgICAgICAgIHBsb3QgZm9ybWF0CiAgICA6cGFyYW0gc2FtcGxlX3dlaWdodDogICBzYW1wbGUgd2VpZ2h0cwogICAgIiIiCiAgICBfZ2NmX2NsZWFyKHBsdCkKICAgIAogICAgY20gPSBtZXRyaWNzLmNvbmZ1c2lvbl9tYXRyaXgobGFiZWxzLCBwcmVkaWN0aW9ucywgc2FtcGxlX3dlaWdodD1Ob25lKQogICAgc25zLmhlYXRtYXAoY20sIGFubm90PVRydWUsIGNtYXA9Y29sb3JtYXAsIHNxdWFyZT1UcnVlKQoKICAgIGZpZyA9IHBsdC5nY2YoKQogICAgZm5hbWUgPSBmIntwbG90c19kaXJ9L3trZXl9LntmbXR9IgogICAgZmlnLnNhdmVmaWcob3MucGF0aC5qb2luKGNvbnRleHQuYXJ0aWZhY3RfcGF0aCwgZm5hbWUpKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoUGxvdEFydGlmYWN0KGtleSwgYm9keT1maWcpLCBsb2NhbF9wYXRoPWZuYW1lKQoKZGVmIHBsb3RfaW1wb3J0YW5jZSgKICAgIGNvbnRleHQsCiAgICBtb2RlbCwKICAgIGtleTogc3RyID0gImZlYXR1cmUtaW1wb3J0YW5jZXMiLAogICAgZm10ID0gInBuZyIKKToKICAgICIiIkRpc3BsYXkgZXN0aW1hdGVkIGZlYXR1cmUgaW1wb3J0YW5jZXMuCiAgICA6cGFyYW0gY29udGV4dDogICAgIGZ1bmN0aW9uIGNvbnRleHQKICAgIDpwYXJhbSBtb2RlbDogICAgICAgZml0dGVkIGxpZ2h0Z2JtIG1vZGVsCiAgICAiIiIKICAgIF9nY2ZfY2xlYXIocGx0KQogICAgCiAgICAjIGNyZWF0ZSBhIGZlYXR1cmUgaW1wb3J0YW5jZSB0YWJsZSB3aXRoIGRlc2lyZWQgbGFiZWxzCiAgICB6aXBwZWQgPSB6aXAobW9kZWwuZmVhdHVyZV9pbXBvcnRhbmNlc18sIGNvbnRleHQuaGVhZGVyKQoKICAgIGZlYXR1cmVfaW1wID0gcGQuRGF0YUZyYW1lKHNvcnRlZCh6aXBwZWQpLCBjb2x1bW5zPVsiZnJlcSIsImZlYXR1cmUiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuc29ydF92YWx1ZXMoYnk9ImZyZXEiLCBhc2NlbmRpbmc9RmFsc2UpCgogICAgcGx0LmZpZ3VyZShmaWdzaXplPSgyMCwgMTApKQogICAgc25zLmJhcnBsb3QoeD0iZnJlcSIsIHk9ImZlYXR1cmUiLCBkYXRhPWZlYXR1cmVfaW1wKQogICAgcGx0LnRpdGxlKCJmZWF0dXJlcyIpCiAgICBwbHQudGlnaHRfbGF5b3V0KCkKCiAgICBmaWcgPSBwbHQuZ2NmKCkKICAgIG9zLm1ha2VkaXJzKG9zLnBhdGguam9pbihjb250ZXh0LmFydGlmYWN0X3BhdGgsICJwbG90cyIpLCBleGlzdF9vaz1UcnVlKQogICAgZmlnLnNhdmVmaWcob3MucGF0aC5qb2luKGNvbnRleHQuYXJ0aWZhY3RfcGF0aCwgZiJwbG90cy97a2V5fS57Zm10fSIpKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoUGxvdEFydGlmYWN0KGYie2tleX0ue2ZtdH0iLCBib2R5PWZpZyksIGxvY2FsX3BhdGg9ZiJwbG90cy97a2V5fS57Zm10fSIpCgogICAgIyBmZWF0dXJlIGltcG9ydGFuY2VzIGFyZSBhbHNvIHNhdmVkIGFzIGEgdGFibGU6CiAgICBmZWF0dXJlX2ltcC50b19jc3Yob3MucGF0aC5qb2luKGNvbnRleHQuYXJ0aWZhY3RfcGF0aCwga2V5KyIuY3N2IikpCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdChrZXkrIi5jc3YiLCBsb2NhbF9wYXRoPWtleSsiLmNzdiIpCgogICAgX2djZl9jbGVhcihwbHQpCgpkZWYgX3Bsb3RfY29uZnVzaW9uX21hdHJpeCh5X3RydWUsIHlfcHJlZCwgY2xhc3Nlcz1bIm5lZyIsICJwb3MiXSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9Tm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBjbWFwPXBsdC5jbS5CbHVlcyk6CiAgICAiIiJUaGlzIGNhbiBiZSBkZXByZWNhdGVkIG9uY2UgaW50ZWwgcHl0aG9uIHVwZ3JhZGVzIHNjaWtpdC1sZWFybiB0byA+MC4yMgogICAgCiAgICBUaGlzIGZ1bmN0aW9uIHByaW50cyBhbmQgcGxvdHMgdGhlIGNvbmZ1c2lvbiBtYXRyaXguCiAgICBOb3JtYWxpemF0aW9uIGNhbiBiZSBhcHBsaWVkIGJ5IHNldHRpbmcgYG5vcm1hbGl6ZT1UcnVlYC4KICAgIAogICAgaHR0cHM6Ly9zY2lraXQtbGVhcm4ub3JnLzAuMjEvYXV0b19leGFtcGxlcy9tb2RlbF9zZWxlY3Rpb24vcGxvdF9jb25mdXNpb25fbWF0cml4Lmh0bWwjc3BoeC1nbHItYXV0by1leGFtcGxlcy1tb2RlbC1zZWxlY3Rpb24tcGxvdC1jb25mdXNpb24tbWF0cml4LXB5CiAgICAiIiIKICAgIGlmIG5vdCB0aXRsZToKICAgICAgICBpZiBub3JtYWxpemU6CiAgICAgICAgICAgIHRpdGxlID0gIk5vcm1hbGl6ZWQgY29uZnVzaW9uIG1hdHJpeCIKICAgICAgICBlbHNlOgogICAgICAgICAgICB0aXRsZSA9ICJDb25mdXNpb24gbWF0cml4LCB3aXRob3V0IG5vcm1hbGl6YXRpb24iCgogICAgIyBDb21wdXRlIGNvbmZ1c2lvbiBtYXRyaXgKICAgIGNtID0gY29uZnVzaW9uX21hdHJpeCh5X3RydWUsIHlfcHJlZCkKICAgICMgT25seSB1c2UgdGhlIGxhYmVscyB0aGF0IGFwcGVhciBpbiB0aGUgZGF0YQogICAgI2NsYXNzZXMgPSBjbGFzc2VzW3VuaXF1ZV9sYWJlbHMoeV90cnVlLCB5X3ByZWQpXQogICAgaWYgbm9ybWFsaXplOgogICAgICAgIGNtID0gY20uYXN0eXBlKCJmbG9hdCIpIC8gY20uc3VtKGF4aXM9MSlbOiwgbnAubmV3YXhpc10KCiAgICBmaWcsIGF4ID0gcGx0LnN1YnBsb3RzKCkKICAgIGltID0gYXguaW1zaG93KGNtLCBpbnRlcnBvbGF0aW9uPSJuZWFyZXN0IiwgY21hcD1jbWFwKQogICAgYXguZmlndXJlLmNvbG9yYmFyKGltLCBheD1heCkKICAgICMgV2Ugd2FudCB0byBzaG93IGFsbCB0aWNrcy4uLgogICAgYXguc2V0KHh0aWNrcz1ucC5hcmFuZ2UoY20uc2hhcGVbMV0pLAogICAgICAgICAgIHl0aWNrcz1ucC5hcmFuZ2UoY20uc2hhcGVbMF0pLAogICAgICAgICAgICMgLi4uIGFuZCBsYWJlbCB0aGVtIHdpdGggdGhlIHJlc3BlY3RpdmUgbGlzdCBlbnRyaWVzCiAgICAgICAgICAgeHRpY2tsYWJlbHM9Y2xhc3NlcywgeXRpY2tsYWJlbHM9Y2xhc3NlcywKICAgICAgICAgICB0aXRsZT10aXRsZSwKICAgICAgICAgICB5bGFiZWw9IlRydWUgbGFiZWwiLAogICAgICAgICAgIHhsYWJlbD0iUHJlZGljdGVkIGxhYmVsIikKCiAgICAjIFJvdGF0ZSB0aGUgdGljayBsYWJlbHMgYW5kIHNldCB0aGVpciBhbGlnbm1lbnQuCiAgICBwbHQuc2V0cChheC5nZXRfeHRpY2tsYWJlbHMoKSwgcm90YXRpb249NDUsIGhhPSJyaWdodCIsCiAgICAgICAgICAgICByb3RhdGlvbl9tb2RlPSJhbmNob3IiKQoKICAgICMgTG9vcCBvdmVyIGRhdGEgZGltZW5zaW9ucyBhbmQgY3JlYXRlIHRleHQgYW5ub3RhdGlvbnMuCiAgICBmbXQgPSAiLjJmIiBpZiBub3JtYWxpemUgZWxzZSAiZCIKICAgIHRocmVzaCA9IGNtLm1heCgpIC8gMi4KICAgIGZvciBpIGluIHJhbmdlKGNtLnNoYXBlWzBdKToKICAgICAgICBmb3IgaiBpbiByYW5nZShjbS5zaGFwZVsxXSk6CiAgICAgICAgICAgIGF4LnRleHQoaiwgaSwgZm9ybWF0KGNtW2ksIGpdLCBmbXQpLAogICAgICAgICAgICAgICAgICAgIGhvcml6b250YWxhbGlnbm1lbnQ9ImNlbnRlciIsCiAgICAgICAgICAgICAgICAgICAgY29sb3I9IndoaXRlIiBpZiBjbVtpLCBqXSA+IHRocmVzaCBlbHNlICJibGFjayIpCiAgICBmaWcudGlnaHRfbGF5b3V0KCkKICAgIHJldHVybiBheCAgICA=
    commands: []
    code_origin: /User/functions/test_classifier/function.yaml
